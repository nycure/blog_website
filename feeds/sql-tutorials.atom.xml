<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom" xmlns:media="http://search.yahoo.com/mrss/"><title>Analytics Drive - SQL Tutorials</title><link href="https://analyticsdrive.tech/" rel="alternate"/><link href="https://analyticsdrive.tech/feeds/sql-tutorials.atom.xml" rel="self"/><id>https://analyticsdrive.tech/</id><updated>2026-02-26T11:46:00+00:00</updated><entry><title>LeetCode 185 Department Top Three Salaries MySQL: A Tutorial</title><link href="https://analyticsdrive.tech/leetcode-185-department-top-three-salaries-mysql-tutorial/" rel="alternate"/><published>2026-02-26T11:46:00+00:00</published><updated>2026-02-26T11:46:00+00:00</updated><author><name>Admin</name></author><id>tag:analyticsdrive.tech,2026-02-26:/leetcode-185-department-top-three-salaries-mysql-tutorial/</id><summary type="html">&lt;p&gt;Master LeetCode 185 Department Top Three Salaries in MySQL with this comprehensive tutorial. Learn window functions, self-joins, and common pitfalls.&lt;/p&gt;</summary><content type="html">&lt;h2 id="leetcode-185-department-top-three-salaries-mysql-a-comprehensive-tutorial"&gt;LeetCode 185 Department Top Three Salaries MySQL: A Comprehensive Tutorial&lt;/h2&gt;
&lt;p&gt;Welcome to this in-depth tutorial on solving one of LeetCode's classic SQL problems: &lt;strong&gt;LeetCode 185 Department Top Three Salaries MySQL&lt;/strong&gt;. This problem challenges your understanding of SQL ranking functions, subqueries, and table joins, making it a frequent topic in developer interviews. Successfully tackling this problem demonstrates a solid grasp of complex data retrieval and manipulation. Throughout this guide, we'll explore multiple robust approaches to help you master this challenge, providing clear explanations and practical code examples to enhance your understanding of database queries and efficient data handling.&lt;/p&gt;
&lt;h2 id="prerequisites"&gt;Prerequisites&lt;/h2&gt;
&lt;p&gt;Before diving into the solution, ensure you have a foundational understanding of the following SQL concepts:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Basic SQL Syntax:&lt;/strong&gt; &lt;code&gt;SELECT&lt;/code&gt;, &lt;code&gt;FROM&lt;/code&gt;, &lt;code&gt;WHERE&lt;/code&gt;, &lt;code&gt;GROUP BY&lt;/code&gt;, &lt;code&gt;ORDER BY&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Table Joins:&lt;/strong&gt; Especially &lt;code&gt;INNER JOIN&lt;/code&gt; for combining data from multiple tables. For another practical application of SQL joins and aggregation, consider &lt;a href="/leetcode-1251-average-selling-price-sql-solution/"&gt;Cracking LeetCode 1251: Average Selling Price SQL&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Subqueries:&lt;/strong&gt; The ability to embed one query within another.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Common Table Expressions (CTEs):&lt;/strong&gt; Understanding &lt;code&gt;WITH&lt;/code&gt; clauses is beneficial for more complex queries.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Database Concepts:&lt;/strong&gt; Familiarity with tables, columns, primary keys, and foreign keys.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;While not strictly required, having a working MySQL environment or access to an online SQL editor (like the one provided by LeetCode) where you can execute and test your queries will significantly aid your learning process.&lt;/p&gt;
&lt;h2 id="understanding-the-problem-leetcode-185-department-top-three-salaries-mysql"&gt;Understanding the Problem: LeetCode 185 Department Top Three Salaries MySQL&lt;/h2&gt;
&lt;p&gt;The core of this tutorial revolves around &lt;strong&gt;LeetCode 185 Department Top Three Salaries MySQL&lt;/strong&gt;. The problem asks you to retrieve the top three highest salaries within &lt;em&gt;each&lt;/em&gt; department. This isn't just about finding the top three salaries overall but rather applying the "top three" criteria independently to every department.&lt;/p&gt;
&lt;p&gt;Let's define the schema for the tables involved:&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Employee&lt;/code&gt; Table:&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left;"&gt;Column Name&lt;/th&gt;
&lt;th style="text-align: left;"&gt;Type&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Id&lt;/td&gt;
&lt;td style="text-align: left;"&gt;int&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Name&lt;/td&gt;
&lt;td style="text-align: left;"&gt;varchar&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Salary&lt;/td&gt;
&lt;td style="text-align: left;"&gt;int&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;DepartmentId&lt;/td&gt;
&lt;td style="text-align: left;"&gt;int&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;Id&lt;/code&gt; is the primary key for this table.
&lt;code&gt;DepartmentId&lt;/code&gt; is a foreign key to the &lt;code&gt;Department&lt;/code&gt; table's &lt;code&gt;Id&lt;/code&gt;.
Each row of this table indicates the ID, name, and salary of an employee, and their department ID.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Department&lt;/code&gt; Table:&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left;"&gt;Column Name&lt;/th&gt;
&lt;th style="text-align: left;"&gt;Type&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Id&lt;/td&gt;
&lt;td style="text-align: left;"&gt;int&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Name&lt;/td&gt;
&lt;td style="text-align: left;"&gt;varchar&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;code&gt;Id&lt;/code&gt; is the primary key for this table.
Each row of this table indicates the ID and name of a department.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Example Data:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Employee&lt;/code&gt; Table:&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left;"&gt;Id&lt;/th&gt;
&lt;th style="text-align: left;"&gt;Name&lt;/th&gt;
&lt;th style="text-align: left;"&gt;Salary&lt;/th&gt;
&lt;th style="text-align: left;"&gt;DepartmentId&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Joe&lt;/td&gt;
&lt;td style="text-align: left;"&gt;85000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;2&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Henry&lt;/td&gt;
&lt;td style="text-align: left;"&gt;80000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;3&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Sam&lt;/td&gt;
&lt;td style="text-align: left;"&gt;60000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;4&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Max&lt;/td&gt;
&lt;td style="text-align: left;"&gt;90000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;5&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Janet&lt;/td&gt;
&lt;td style="text-align: left;"&gt;69000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;6&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Randy&lt;/td&gt;
&lt;td style="text-align: left;"&gt;85000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;7&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Will&lt;/td&gt;
&lt;td style="text-align: left;"&gt;70000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;8&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Alice&lt;/td&gt;
&lt;td style="text-align: left;"&gt;90000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;9&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Bob&lt;/td&gt;
&lt;td style="text-align: left;"&gt;85000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;10&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Charlie&lt;/td&gt;
&lt;td style="text-align: left;"&gt;75000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;11&lt;/td&gt;
&lt;td style="text-align: left;"&gt;David&lt;/td&gt;
&lt;td style="text-align: left;"&gt;60000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;&lt;code&gt;Department&lt;/code&gt; Table:&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left;"&gt;Id&lt;/th&gt;
&lt;th style="text-align: left;"&gt;Name&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;td style="text-align: left;"&gt;IT&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;2&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Sales&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;3&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Marketing&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;&lt;strong&gt;Expected Output:&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left;"&gt;Department&lt;/th&gt;
&lt;th style="text-align: left;"&gt;Employee&lt;/th&gt;
&lt;th style="text-align: left;"&gt;Salary&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;IT&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Max&lt;/td&gt;
&lt;td style="text-align: left;"&gt;90000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;IT&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Joe&lt;/td&gt;
&lt;td style="text-align: left;"&gt;85000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;IT&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Randy&lt;/td&gt;
&lt;td style="text-align: left;"&gt;85000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Sales&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Henry&lt;/td&gt;
&lt;td style="text-align: left;"&gt;80000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Sales&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Sam&lt;/td&gt;
&lt;td style="text-align: left;"&gt;60000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Marketing&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Alice&lt;/td&gt;
&lt;td style="text-align: left;"&gt;90000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Marketing&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Bob&lt;/td&gt;
&lt;td style="text-align: left;"&gt;85000&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;Marketing&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Charlie&lt;/td&gt;
&lt;td style="text-align: left;"&gt;75000&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Notice a few critical aspects from the example:
*   &lt;strong&gt;Ties:&lt;/strong&gt; If multiple employees have the same salary, and that salary falls within the top three, all those employees should be included. For instance, in the 'IT' department, Joe and Randy both earn 85000 and are in the top three. This implies we need a ranking function that handles ties appropriately.
*   &lt;strong&gt;Fewer than Three:&lt;/strong&gt; If a department has fewer than three employees, all of them should be listed. The 'Sales' department demonstrates this with only two employees.
*   &lt;strong&gt;Output Format:&lt;/strong&gt; The final output requires the Department Name, Employee Name, and Salary. This means we will need to join the &lt;code&gt;Employee&lt;/code&gt; and &lt;code&gt;Department&lt;/code&gt; tables.&lt;/p&gt;
&lt;p&gt;These nuances make the problem more intricate than a simple &lt;code&gt;ORDER BY&lt;/code&gt; and &lt;code&gt;LIMIT&lt;/code&gt; clause, requiring more advanced SQL techniques. We will explore two primary methods to solve this: one leveraging modern SQL window functions and another using a more traditional self-join and subquery approach.&lt;/p&gt;
&lt;h2 id="approach-1-solving-leetcode-185-with-window-functions-in-mysql"&gt;Approach 1: Solving LeetCode 185 with Window Functions in MySQL&lt;/h2&gt;
&lt;p&gt;Window functions are a powerful feature in SQL that perform calculations across a set of table rows that are somehow related to the current row. For ranking problems like &lt;strong&gt;LeetCode 185 Department Top Three Salaries MySQL&lt;/strong&gt;, they are often the most elegant and efficient solution. MySQL has supported window functions since version 8.0, making them a standard tool for such tasks.&lt;/p&gt;
&lt;h3 id="introduction-to-window-functions-for-ranking"&gt;Introduction to Window Functions for Ranking&lt;/h3&gt;
&lt;p&gt;Several window functions are available for ranking:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ROW_NUMBER()&lt;/code&gt;:&lt;/strong&gt; Assigns a unique rank to each row within its partition, even if values are identical. If two employees have the same salary, they will get different row numbers.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;RANK()&lt;/code&gt;:&lt;/strong&gt; Assigns the same rank to rows with identical values and then skips the subsequent rank numbers. For example, if two employees are ranked #1, the next distinct rank would be #3.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;DENSE_RANK()&lt;/code&gt;:&lt;/strong&gt; Assigns the same rank to rows with identical values but does &lt;em&gt;not&lt;/em&gt; skip subsequent rank numbers. If two employees are ranked #1, the next distinct rank would be #2.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Given the problem statement's requirement to include all employees tied for a top spot (e.g., Joe and Randy both at 85000), &lt;code&gt;DENSE_RANK()&lt;/code&gt; is the most suitable choice because it handles ties by assigning them the same rank and continues the numbering sequentially without gaps.&lt;/p&gt;
&lt;p&gt;The general syntax for a window function is:
&lt;code&gt;FUNCTION() OVER (PARTITION BY expression1, ... ORDER BY expression2 [ASC|DESC], ...)&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;PARTITION BY&lt;/code&gt;&lt;/strong&gt;: Divides the rows into groups (partitions) where the window function operates independently within each group. In our case, we want to rank employees &lt;em&gt;per department&lt;/em&gt;, so we'll partition by &lt;code&gt;DepartmentId&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;code&gt;ORDER BY&lt;/code&gt;&lt;/strong&gt;: Specifies the order of rows within each partition. We want the highest salaries first, so we'll order by &lt;code&gt;Salary DESC&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="step-1-partitioning-data-by-department"&gt;Step 1: Partitioning Data by Department&lt;/h3&gt;
&lt;p&gt;The first step is to apply &lt;code&gt;DENSE_RANK()&lt;/code&gt; to the &lt;code&gt;Employee&lt;/code&gt; table, partitioning the data by &lt;code&gt;DepartmentId&lt;/code&gt;. This ensures that the ranking restarts for each new department.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;DENSE_RANK&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OVER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PARTITION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ORDER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DESC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rn&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Let's look at the partial output for the &lt;code&gt;IT&lt;/code&gt; department (DepartmentId = 1) if we run this query:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th style="text-align: left;"&gt;Id&lt;/th&gt;
&lt;th style="text-align: left;"&gt;Name&lt;/th&gt;
&lt;th style="text-align: left;"&gt;Salary&lt;/th&gt;
&lt;th style="text-align: left;"&gt;DepartmentId&lt;/th&gt;
&lt;th style="text-align: left;"&gt;rn&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;4&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Max&lt;/td&gt;
&lt;td style="text-align: left;"&gt;90000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Joe&lt;/td&gt;
&lt;td style="text-align: left;"&gt;85000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;td style="text-align: left;"&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;6&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Randy&lt;/td&gt;
&lt;td style="text-align: left;"&gt;85000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;td style="text-align: left;"&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;7&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Will&lt;/td&gt;
&lt;td style="text-align: left;"&gt;70000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;td style="text-align: left;"&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style="text-align: left;"&gt;5&lt;/td&gt;
&lt;td style="text-align: left;"&gt;Janet&lt;/td&gt;
&lt;td style="text-align: left;"&gt;69000&lt;/td&gt;
&lt;td style="text-align: left;"&gt;1&lt;/td&gt;
&lt;td style="text-align: left;"&gt;4&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;As you can see, Max gets rank 1. Joe and Randy, both with 85000, correctly get rank 2 due to &lt;code&gt;DENSE_RANK()&lt;/code&gt;. Will gets rank 3, and Janet gets rank 4. This is exactly what we need for the "top three" requirement.&lt;/p&gt;
&lt;h3 id="step-2-filtering-for-the-top-three-salaries-per-department"&gt;Step 2: Filtering for the Top Three Salaries per Department&lt;/h3&gt;
&lt;p&gt;Once we have assigned a rank to each employee within their respective departments, the next step is to filter these results to include only those employees whose rank is 3 or less. We can achieve this by wrapping our previous query in a Common Table Expression (CTE) or a subquery. Using a CTE often improves readability.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;WITH&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EmployeeRanked&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;DENSE_RANK&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OVER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PARTITION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ORDER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DESC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rn&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;EmployeeRanked&lt;/span&gt;
&lt;span class="k"&gt;WHERE&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;rn&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;After this step, our result set will contain all employees who are among the top three highest earners in their department, considering ties.&lt;/p&gt;
&lt;h3 id="step-3-selecting-and-renaming-final-columns"&gt;Step 3: Selecting and Renaming Final Columns&lt;/h3&gt;
&lt;p&gt;The final output requires the Department Name, Employee Name, and Salary. Our current result set only has &lt;code&gt;DepartmentId&lt;/code&gt;, not the department name. Therefore, we need to join our filtered results with the &lt;code&gt;Department&lt;/code&gt; table to retrieve the department names.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;WITH&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EmployeeRanked&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;DENSE_RANK&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OVER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;PARTITION&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ORDER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DESC&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rn&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Department&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;er&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;er&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;EmployeeRanked&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;er&lt;/span&gt;
&lt;span class="k"&gt;INNER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;JOIN&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Department&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;er&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;
&lt;span class="k"&gt;WHERE&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;er&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rn&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="k"&gt;ORDER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;er&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DESC&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;In this final query:
*   We aliased the &lt;code&gt;Employee&lt;/code&gt; table as &lt;code&gt;e&lt;/code&gt; and &lt;code&gt;Department&lt;/code&gt; table as &lt;code&gt;d&lt;/code&gt; for brevity.
*   We selected &lt;code&gt;d.Name&lt;/code&gt; as &lt;code&gt;Department&lt;/code&gt;, &lt;code&gt;er.Employee&lt;/code&gt; (which was aliased &lt;code&gt;Name&lt;/code&gt; from the &lt;code&gt;Employee&lt;/code&gt; table), and &lt;code&gt;er.Salary&lt;/code&gt;.
*   We performed an &lt;code&gt;INNER JOIN&lt;/code&gt; between &lt;code&gt;EmployeeRanked&lt;/code&gt; (our CTE) and &lt;code&gt;Department&lt;/code&gt; on their respective &lt;code&gt;DepartmentId&lt;/code&gt; and &lt;code&gt;Id&lt;/code&gt; columns.
*   The &lt;code&gt;WHERE er.rn &amp;lt;= 3&lt;/code&gt; clause remains crucial for filtering.
*   An &lt;code&gt;ORDER BY&lt;/code&gt; clause is added to present the results cleanly, first by department name, then by salary in descending order within each department. This isn't strictly necessary for correctness on LeetCode but is good practice for readable output.&lt;/p&gt;
&lt;p&gt;This window function approach is generally preferred for its clarity, conciseness, and often better performance on modern database systems compared to older methods involving extensive self-joins.&lt;/p&gt;
&lt;h3 id="advantages-of-window-functions"&gt;Advantages of Window Functions&lt;/h3&gt;
&lt;p&gt;The window function approach offers several compelling benefits:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Readability:&lt;/strong&gt; The logic of partitioning and ordering for ranking is clearly expressed within the &lt;code&gt;OVER()&lt;/code&gt; clause, making the query easier to understand and maintain.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Conciseness:&lt;/strong&gt; It typically requires less code than self-join alternatives, especially for more complex ranking scenarios.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Performance:&lt;/strong&gt; Modern SQL optimizers are highly adept at processing window functions efficiently. For large datasets, this approach can often outperform queries relying heavily on subqueries and self-joins, which might lead to multiple table scans.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Flexibility:&lt;/strong&gt; Easily adaptable to different ranking requirements (e.g., &lt;code&gt;RANK()&lt;/code&gt;, &lt;code&gt;ROW_NUMBER()&lt;/code&gt;, &lt;code&gt;NTILE()&lt;/code&gt;, not just &lt;code&gt;DENSE_RANK()&lt;/code&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="approach-2-leetcode-185-department-top-three-salaries-a-traditional-self-join-approach"&gt;Approach 2: LeetCode 185 Department Top Three Salaries: A Traditional Self-Join Approach&lt;/h2&gt;
&lt;p&gt;Before the widespread adoption of window functions, solving ranking problems like &lt;strong&gt;LeetCode 185 Department Top Three Salaries MySQL&lt;/strong&gt; often involved clever use of self-joins and subqueries. This traditional method, while sometimes more verbose, is still valuable to understand as it showcases fundamental SQL logic and can be necessary in environments where window functions are not supported (e.g., older MySQL versions).&lt;/p&gt;
&lt;h3 id="the-core-idea-counting-distinct-higher-salaries"&gt;The Core Idea: Counting Distinct Higher Salaries&lt;/h3&gt;
&lt;p&gt;The fundamental principle behind this approach is to count, for each employee, how many other employees in the &lt;em&gt;same department&lt;/em&gt; have a &lt;em&gt;higher or equal&lt;/em&gt; salary. If an employee has fewer than three (i.e., 0, 1, or 2) other employees with a higher or equal distinct salary within their department, then that employee is in the top three.&lt;/p&gt;
&lt;p&gt;Let's illustrate with an example:
*   Max (IT, 90000): In the IT department, there are no employees with a salary higher than 90000. So, count is 1 (Max's own salary). Max is in the top 3.
*   Joe (IT, 85000): In the IT department, only Max has a salary higher than 85000. Joe himself has 85000. The distinct salaries higher than or equal to Joe's are 90000 and 85000. Count = 2. Joe is in the top 3.
*   Randy (IT, 85000): Same as Joe, distinct salaries higher than or equal to Randy's are 90000 and 85000. Count = 2. Randy is in the top 3.
*   Will (IT, 70000): In the IT department, Max (90000), Joe (85000), and Randy (85000) have salaries higher than 70000. Will himself has 70000. The distinct salaries higher than or equal to Will's are 90000, 85000, and 70000. Count = 3. Will is in the top 3.
*   Janet (IT, 69000): In the IT department, Max (90000), Joe (85000), Randy (85000), and Will (70000) have salaries higher than 69000. Janet herself has 69000. The distinct salaries higher than or equal to Janet's are 90000, 85000, 70000, and 69000. Count = 4. Janet is NOT in the top 3.&lt;/p&gt;
&lt;p&gt;This logic correctly handles ties because we are counting &lt;em&gt;distinct&lt;/em&gt; salaries. If Joe and Randy both earn 85000, the salary 85000 is only counted once for the purpose of establishing a distinct rank.&lt;/p&gt;
&lt;h3 id="step-1-self-joining-the-employee-table"&gt;Step 1: Self-Joining the Employee Table&lt;/h3&gt;
&lt;p&gt;We need to join the &lt;code&gt;Employee&lt;/code&gt; table with itself. Let's call the first instance &lt;code&gt;e1&lt;/code&gt; and the second &lt;code&gt;e2&lt;/code&gt;.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;The join condition &lt;code&gt;e1.DepartmentId = e2.DepartmentId&lt;/code&gt; ensures we only compare employees within the same department.&lt;/li&gt;
&lt;li&gt;The condition &lt;code&gt;e1.Salary &amp;lt;= e2.Salary&lt;/code&gt; is crucial. For each &lt;code&gt;e1&lt;/code&gt; employee, we are looking for &lt;code&gt;e2&lt;/code&gt; employees in the same department who have a salary &lt;em&gt;greater than or equal to&lt;/em&gt; &lt;code&gt;e1&lt;/code&gt;'s salary.&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HigherOrEqualSalary&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;
&lt;span class="k"&gt;JOIN&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This query will produce many rows. For each employee &lt;code&gt;e1&lt;/code&gt;, it will list all salaries (&lt;code&gt;e2.Salary&lt;/code&gt;) from employees in the same department who earn equal to or more than &lt;code&gt;e1&lt;/code&gt;.&lt;/p&gt;
&lt;h3 id="step-2-counting-distinct-salaries-within-each-department"&gt;Step 2: Counting Distinct Salaries within Each Department&lt;/h3&gt;
&lt;p&gt;Now, for each employee &lt;code&gt;e1&lt;/code&gt;, we need to count the &lt;em&gt;distinct&lt;/em&gt; &lt;code&gt;HigherOrEqualSalary&lt;/code&gt; values. This count will tell us their effective rank (1 for highest, 2 for second highest, etc., handling ties). We achieve this by using &lt;code&gt;GROUP BY e1.Id&lt;/code&gt; (or &lt;code&gt;e1.Name&lt;/code&gt;, &lt;code&gt;e1.Salary&lt;/code&gt;, &lt;code&gt;e1.DepartmentId&lt;/code&gt; to uniquely identify each &lt;code&gt;e1&lt;/code&gt; employee) and &lt;code&gt;COUNT(DISTINCT e2.Salary)&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;COUNT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;DISTINCT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;salary_rank&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;
&lt;span class="k"&gt;JOIN&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;
&lt;span class="k"&gt;GROUP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;The &lt;code&gt;GROUP BY&lt;/code&gt; clause is essential here because &lt;code&gt;COUNT(DISTINCT e2.Salary)&lt;/code&gt; is an aggregate function. We group by all columns of &lt;code&gt;e1&lt;/code&gt; that we want to keep in the final result.&lt;/p&gt;
&lt;h3 id="step-3-filtering-for-top-three-salaries"&gt;Step 3: Filtering for Top Three Salaries&lt;/h3&gt;
&lt;p&gt;With &lt;code&gt;salary_rank&lt;/code&gt; calculated, we can now filter the results using a &lt;code&gt;HAVING&lt;/code&gt; clause, selecting only those employees where &lt;code&gt;salary_rank&lt;/code&gt; is less than or equal to 3.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;
&lt;span class="k"&gt;JOIN&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;
&lt;span class="k"&gt;GROUP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;
&lt;span class="k"&gt;HAVING&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;COUNT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;DISTINCT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;This query now gives us all the required employees and their salaries that fall within the top three.&lt;/p&gt;
&lt;h3 id="step-4-retrieving-department-names"&gt;Step 4: Retrieving Department Names&lt;/h3&gt;
&lt;p&gt;Finally, similar to the window function approach, we need to join this result with the &lt;code&gt;Department&lt;/code&gt; table to fetch the actual department names. We can embed the entire self-join and grouping logic within a subquery.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Department&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e_top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;e_top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;
&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Department&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;
&lt;span class="k"&gt;JOIN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;SELECT&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;JOIN&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Employee&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AND&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;GROUP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;HAVING&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;COUNT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;DISTINCT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e_top&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ON&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e_top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;DepartmentId&lt;/span&gt;
&lt;span class="k"&gt;ORDER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BY&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e_top&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Salary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DESC&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Here, the subquery named &lt;code&gt;e_top&lt;/code&gt; calculates the employees in the top three salaries per department. This &lt;code&gt;e_top&lt;/code&gt; result set is then joined with the &lt;code&gt;Department&lt;/code&gt; table to get the department names. An &lt;code&gt;ORDER BY&lt;/code&gt; clause is added for presentation.&lt;/p&gt;
&lt;h3 id="disadvantages-of-the-self-join-approach"&gt;Disadvantages of the Self-Join Approach&lt;/h3&gt;
&lt;p&gt;While effective, the self-join approach has some drawbacks:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Complexity:&lt;/strong&gt; The logic can be less intuitive and harder to follow than window functions, especially for those new to SQL.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Verbosity:&lt;/strong&gt; The queries tend to be longer and involve more nested structures, which can affect readability and maintenance.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Performance on Large Datasets:&lt;/strong&gt; For very large tables, self-joins combined with &lt;code&gt;GROUP BY&lt;/code&gt; and &lt;code&gt;COUNT(DISTINCT)&lt;/code&gt; can sometimes be less performant than optimized window functions, as they might involve more intermediate table scans and sorting. However, performance can vary based on database system and specific query optimizer implementations.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="common-mistakes-and-optimization-tips"&gt;Common Mistakes and Optimization Tips&lt;/h2&gt;
&lt;p&gt;When tackling the &lt;strong&gt;LeetCode 185 Department Top Three Salaries MySQL&lt;/strong&gt; problem, several common pitfalls can arise. Being aware of these can save you debugging time and lead to more robust solutions.&lt;/p&gt;
&lt;h3 id="common-mistakes"&gt;Common Mistakes&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Forgetting &lt;code&gt;PARTITION BY&lt;/code&gt; in Window Functions:&lt;/strong&gt; A frequent error is to use &lt;code&gt;DENSE_RANK() OVER (ORDER BY Salary DESC)&lt;/code&gt; without &lt;code&gt;PARTITION BY DepartmentId&lt;/code&gt;. This will rank employees across the &lt;em&gt;entire company&lt;/em&gt; instead of ranking them &lt;em&gt;within each department&lt;/em&gt;, failing to meet the problem's core requirement.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Using &lt;code&gt;ROW_NUMBER()&lt;/code&gt; Instead of &lt;code&gt;DENSE_RANK()&lt;/code&gt; for Ties:&lt;/strong&gt; As discussed, &lt;code&gt;ROW_NUMBER()&lt;/code&gt; assigns a unique rank even if salaries are identical. If the problem explicitly asks for "top N distinct salaries" or "top N employees by salary, breaking ties arbitrarily," &lt;code&gt;ROW_NUMBER()&lt;/code&gt; might be appropriate. However, for "top N salaries where ties share rank," &lt;code&gt;DENSE_RANK()&lt;/code&gt; is almost always the correct choice. Using &lt;code&gt;RANK()&lt;/code&gt; would also work but would introduce gaps in the ranking if ties exist (e.g., 1, 1, 3 instead of 1, 1, 2), which might not be desired for a "top three" count.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Incorrect Join Conditions in Self-Join:&lt;/strong&gt; In the traditional approach, missing &lt;code&gt;e1.DepartmentId = e2.DepartmentId&lt;/code&gt; or using &lt;code&gt;e1.Salary &amp;lt; e2.Salary&lt;/code&gt; instead of &lt;code&gt;e1.Salary &amp;lt;= e2.Salary&lt;/code&gt; can lead to incorrect counts. If you use &lt;code&gt;&amp;lt;&lt;/code&gt;, you'll effectively be counting employees with &lt;em&gt;strictly higher&lt;/em&gt; salaries, which changes the ranking logic. Counting higher &lt;em&gt;or equal&lt;/em&gt; distinct salaries correctly establishes the rank for employees with ties.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Performance Issues with Subqueries/Self-Joins on Large Datasets:&lt;/strong&gt; While the self-join approach is conceptually sound, repeatedly joining large tables with complex aggregate functions in subqueries can lead to performance bottlenecks. Without proper indexing, such queries can become very slow.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="optimization-tips"&gt;Optimization Tips&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Indexing:&lt;/strong&gt; For optimal performance, especially with large datasets, ensure that your &lt;code&gt;Employee&lt;/code&gt; table has appropriate indexes. An index on &lt;code&gt;(DepartmentId, Salary)&lt;/code&gt; is crucial for both window function and self-join approaches.&lt;ul&gt;
&lt;li&gt;&lt;code&gt;CREATE INDEX idx_department_salary ON Employee (DepartmentId, Salary DESC);&lt;/code&gt;
This index allows the database to quickly group by &lt;code&gt;DepartmentId&lt;/code&gt; and then efficiently order by &lt;code&gt;Salary&lt;/code&gt; within each department, which is fundamental to both ranking methods.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Use CTEs for Readability:&lt;/strong&gt; While subqueries work, Common Table Expressions (CTEs) using the &lt;code&gt;WITH&lt;/code&gt; clause significantly improve the readability and maintainability of complex SQL queries. Break down your logic into smaller, named, logical steps.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Understand Your Database's Capabilities:&lt;/strong&gt; Be aware of the SQL features supported by your specific database version. MySQL 8.0+ supports window functions, but older versions do not. Knowing this will guide you in choosing the appropriate solution. For other algorithmic challenges, exploring problems like &lt;a href="/leetcode-127-word-ladder-bfs-tutorial/"&gt;Leetcode 127 Word Ladder: Master the BFS Approach Easily&lt;/a&gt; can broaden your problem-solving toolkit.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Test with Edge Cases:&lt;/strong&gt; Always test your solution with various edge cases:&lt;ul&gt;
&lt;li&gt;Departments with fewer than three employees.&lt;/li&gt;
&lt;li&gt;Departments where all employees have the same salary.&lt;/li&gt;
&lt;li&gt;Departments with many employees who have tied salaries for the top spots.&lt;/li&gt;
&lt;li&gt;Departments with no employees (though the problem usually implies departments will have at least one employee).&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;By keeping these points in mind, you can write more efficient, correct, and maintainable SQL solutions for ranking problems.&lt;/p&gt;
&lt;h2 id="conclusion"&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Solving &lt;strong&gt;LeetCode 185 Department Top Three Salaries MySQL&lt;/strong&gt; is an excellent way to solidify your SQL skills and prepare for technical interviews. We've explored two primary methods to conquer this challenge: the elegant and modern window function approach, leveraging &lt;code&gt;DENSE_RANK()&lt;/code&gt;, and the traditional self-join with subquery method. Each approach offers unique insights into SQL's capabilities for complex data manipulation.&lt;/p&gt;
&lt;p&gt;The window function approach, particularly with &lt;code&gt;DENSE_RANK()&lt;/code&gt;, stands out for its clarity, conciseness, and often superior performance on modern database systems due to optimized internal handling. It's generally the recommended solution when supported. However, understanding the self-join method is equally valuable, demonstrating fundamental SQL logic and proving useful in environments with older database versions. By mastering both techniques and being mindful of common pitfalls and optimization strategies, you're well-equipped to tackle similar ranking problems in any SQL context. Continued practice with varied LeetCode problems will further sharpen your database query prowess. Additionally, consider exploring broader career paths outlined in a &lt;a href="/data-analyst-career-roadmap-infographic/"&gt;Data Analyst Career Roadmap&lt;/a&gt; to see how these SQL skills fit into the larger data ecosystem.&lt;/p&gt;
&lt;h2 id="frequently-asked-questions"&gt;Frequently Asked Questions&lt;/h2&gt;
&lt;p&gt;&lt;strong&gt;Q: Why is DENSE_RANK() preferred over RANK() or ROW_NUMBER() for this problem?&lt;/strong&gt;
A: &lt;code&gt;DENSE_RANK()&lt;/code&gt; is preferred because it assigns the same rank to employees with identical salaries (handling ties correctly) and then continues the ranking sequentially without gaps. &lt;code&gt;ROW_NUMBER()&lt;/code&gt; would give unique ranks even to tied salaries, potentially excluding some top earners, while &lt;code&gt;RANK()&lt;/code&gt; would introduce gaps in the ranking (e.g., 1, 1, 3 instead of 1, 1, 2), which doesn't align with the "top three" count including all tied individuals.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Q: Can I solve this problem without window functions in older MySQL versions?&lt;/strong&gt;
A: Yes, the "Traditional Self-Join Approach" detailed in this tutorial is specifically designed for environments where window functions are not available, such as MySQL versions prior to 8.0. It leverages self-joins, &lt;code&gt;GROUP BY&lt;/code&gt;, and &lt;code&gt;COUNT(DISTINCT)&lt;/code&gt; to achieve the same ranking logic.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Q: What are the performance considerations between the window function and self-join approaches?&lt;/strong&gt;
A: Generally, for modern database systems (MySQL 8.0+), the window function approach is often more performant and efficient, especially with large datasets, due to highly optimized internal implementations. The self-join approach, while functional, can sometimes lead to more resource-intensive queries involving multiple table scans and complex aggregations, potentially being slower on very large tables without proper indexing.&lt;/p&gt;
&lt;h2 id="further-reading-resources"&gt;Further Reading &amp;amp; Resources&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;MySQL 8.0 Reference Manual - Window Functions: &lt;code&gt;https://dev.mysql.com/doc/refman/8.0/en/window-functions-usage.html&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;LeetCode Problem 185: Department Top Three Salaries: &lt;code&gt;https://leetcode.com/problems/department-top-three-salaries/&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Wikipedia - SQL: &lt;code&gt;https://en.wikipedia.org/wiki/SQL&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Stack Overflow - SQL Tag: &lt;code&gt;https://stackoverflow.com/questions/tagged/sql&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="SQL Tutorials"/><category term="LeetCode"/><category term="SQL"/><category term="MySQL"/><category term="Database"/><category term="Window Functions"/><category term="Ranking"/><category term="Interview Prep"/><media:content height="675" medium="image" type="image/webp" url="https://analyticsdrive.tech/images/leetcode-185-department-top-three-salaries-mysql-tutorial.webp" width="1200"/><media:title type="plain">LeetCode 185 Department Top Three Salaries MySQL: A Tutorial</media:title><media:description type="plain">Master LeetCode 185 Department Top Three Salaries in MySQL with this comprehensive tutorial. Learn window functions, self-joins, and common pitfalls.</media:description></entry></feed>