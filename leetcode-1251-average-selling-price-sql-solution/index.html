<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cracking LeetCode 1251: Average Selling Price SQL | Analytics Drive
</title>

    <!-- Canonical URL -->
    <link rel="canonical" href="https://analyticsdrive.tech/leetcode-1251-average-selling-price-sql-solution/" />

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="https://analyticsdrive.tech/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://analyticsdrive.tech/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://analyticsdrive.tech/favicon-16x16.png">
    <link rel="manifest" href="https://analyticsdrive.tech/site.webmanifest">
    <link rel="icon" href="https://analyticsdrive.tech/favicon.ico" type="image/x-icon" />

    <!-- RSS Feed -->
    <link rel="alternate" type="application/atom+xml" title="Analytics Drive Atom Feed"
        href="https://analyticsdrive.tech/feeds/all.atom.xml" />

    <!-- SEO Meta Tags -->
    <meta name="description" content="Master LeetCode 1251: Average Selling Price. Learn to calculate average product prices using SQL JOINS, GROUP BY, and handling date-based conditions for..." />
    <meta name="keywords" content="Breaking news, live coverage, investigations, analysis, photos ,opinions, Analytics Drive" />
    <meta name="author" content="Analytics Drive" />

    <!-- Open Graph -->
    <meta property="og:title" content="Cracking LeetCode 1251: Average Selling Price SQL" />
    <meta property="og:description"
        content="Master LeetCode 1251: Average Selling Price. Learn to calculate average product prices using SQL JOINS, GROUP BY, and handling date-based conditions for..." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://analyticsdrive.tech/leetcode-1251-average-selling-price-sql-solution/index.html" />
    <meta property="og:image" content="https://analyticsdrive.tech/images/leetcode-1251-average-selling-price-sql-solution.webp" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@analyticsdrive" />
    <meta name="twitter:title" content="Cracking LeetCode 1251: Average Selling Price SQL" />
    <meta name="twitter:description" content="Master LeetCode 1251: Average Selling Price. Learn to calculate average product prices using SQL JOINS, GROUP BY, and handling date-based conditions for..." />
    <meta name="twitter:image" content="https://analyticsdrive.tech/images/leetcode-1251-average-selling-price-sql-solution.webp" />


    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-P1LT4885S9"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-P1LT4885S9');
    </script>

    <!-- Schema.org JSON-LD -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Analytics Drive",
      "url": "https://analyticsdrive.tech",
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://analyticsdrive.tech/search.html?q={search_term_string}",
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Analytics Drive",
      "url": "https://analyticsdrive.tech",
      "logo": "https://analyticsdrive.tech/theme/images/logo.png",
      "sameAs": [
        "https://twitter.com/analyticsdrive",        "https://www.facebook.com/profile.php?id=61588072082428",        "https://www.instagram.com/analyticsdrive",        "https://www.reddit.com/r/Analyticsdrive/"      ]
    }
    </script>

    <!-- CSS -->
    <style>
        /* 
 * THE ANALYTICS POST - NEWSPAPER THEME
 * (c) 2026 - Classic Journalism Aesthetic
 */

        :root {
            /* Colors */
            --bg-paper: #ffffff;
            --text-ink: #2a2a2a;
            --text-muted: #666;
            --border-line: #e0e0e0;
            --accent: #000;
            /* Classic Black */
            --link-color: #005b96;
            /* Classic Blue */

            /* Typography */
            --font-masthead: 'UnifrakturMaguntia', cursive;
            --font-headline: 'Playfair Display', serif;
            --font-body: 'Libre Baskerville', serif;
            --font-ui: 'Libre Franklin', sans-serif;

            /* Layout */
            --max-width: 1100px;
            --spacing: 2rem;

            /* Component Specific */
            --bg-footer: #f9f9f9;
            --text-summary: #444444;
        }

        /* Dark Mode Overrides */
        [data-theme="dark"] {
            --bg-paper: #121212;
            --text-ink: #e0e0e0;
            --text-muted: #a0a0a0;
            --border-line: #333333;
            --accent: #ffffff;
            --link-color: #64b5f6;

            /* Component Override */
            --bg-footer: #1e1e1e;
            --text-summary: #d0d0d0;
        }

        /* Base */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--bg-paper);
            color: var(--text-ink);
            font-family: var(--font-body);
            font-size: 1.125rem;
            line-height: 1.8;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        a {
            color: var(--link-color);
            text-decoration: none;
            transition: 0.2s ease;
        }

        a:hover {
            text-decoration: underline;
            color: #003366;
        }

        /* Layout Container */
        .container {
            max-width: var(--max-width);
            margin: 0 auto;
            padding: 0 var(--spacing);
        }

        /* Header / Masthead */
        .site-header {
            padding: 2rem 0 1rem;
            margin-bottom: 2rem;
            text-align: center;
            border-bottom: 1px solid var(--accent);
            position: relative;
            /* Anchor for absolute positioned elements */
            z-index: 100;
        }

        .site-header .logo {
            font-family: var(--font-masthead);
            font-size: 4rem;
            color: var(--accent);
            text-decoration: none;
            display: block;
            margin-bottom: 1rem;
            line-height: 1;
        }



        .site-header .logo .dot {
            display: none;
            /* Hide the modern dot */
        }

        /* Navigation */
        .main-nav {
            border-top: 1px solid var(--border-line);
            border-bottom: 3px double var(--border-line);
            padding: 0.75rem 0;
            position: relative;
            /* Anchor for toggle button */
        }

        .main-nav ul {
            list-style: none;
            display: flex;
            justify-content: center;
            gap: 2rem;
            font-family: var(--font-ui);
            text-transform: uppercase;
            font-size: 0.85rem;
            font-weight: 700;
            letter-spacing: 1px;
        }

        .main-nav a {
            color: var(--text-ink);
            text-decoration: none;
        }

        .main-nav a:hover {
            color: #555;
            text-decoration: underline;
        }

        /* Theme Toggle (Integrated in Nav) */
        .theme-toggle {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: transparent;
            border: none;
            cursor: pointer;
            color: var(--text-ink);
            font-size: 1.25rem;
            padding: 0.5rem;
            z-index: 100;
            transition: transform 0.3s ease;
        }

        .theme-toggle:hover {
            transform: translateY(-50%) rotate(15deg);
        }

        /* Hero Section (Top Story) */
        .hero {
            text-align: center;
            padding: 3rem 0;
            border-bottom: 1px solid var(--border-line);
            margin-bottom: 3rem;
        }

        .hero h1 {
            font-family: var(--font-headline);
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1.1;
            margin-bottom: 1rem;
            color: var(--accent);
        }

        .hero p {
            font-family: var(--font-body);
            font-style: italic;
            color: var(--text-muted);
            font-size: 1.25rem;
            max-width: 700px;
            margin: 0 auto;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 2rem;
            margin: 3rem 0;
            font-family: var(--font-ui);
            font-weight: 700;
            text-transform: uppercase;
            font-size: 0.9rem;
            letter-spacing: 1px;
        }

        .pagination a {
            padding: 0.5rem 1.5rem;
            border: 1px solid var(--border-line);
            color: var(--text-ink);
            transition: 0.2s;
        }

        .pagination a:hover {
            background: var(--accent);
            color: #fff;
            text-decoration: none;
            border-color: var(--accent);
        }

        /* Post Grid (Masonry / Columns) */
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 2rem;
            padding-bottom: 4rem;
        }

        .post-card {
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--border-line);
        }

        /* Remove CSS Grid lines for a cleaner look, stick to bottom borders */

        .post-meta {
            font-family: var(--font-ui);
            font-size: 0.75rem;
            color: var(--text-muted);
            text-transform: uppercase;
            margin-bottom: 0.5rem;
            display: block;
        }

        .post-meta .category a {
            color: #d00;
            /* Red for category like 'Politics', 'Sports' */
            font-weight: 700;
            text-decoration: none;
        }

        .post-card h3 {
            font-family: var(--font-headline);
            font-size: 1.75rem;
            line-height: 1.2;
            margin-bottom: 1rem;
        }

        .post-card h3 a {
            color: var(--accent);
            text-decoration: none;
        }

        .post-card h3 a:hover {
            color: #444;
            text-decoration: none;
            /* Already handled by color change */
        }


        .post-card p {
            color: var(--text-summary);
            font-size: 1rem;
            margin-bottom: 1rem;
            line-height: 1.6;
        }

        .read-more {
            font-family: var(--font-ui);
            font-size: 0.85rem;
            font-weight: 700;
            text-transform: uppercase;
            color: var(--link-color);
        }

        /* Article Page */
        .single-post header {
            text-align: center;
            margin-bottom: 3rem;
            border-bottom: 1px solid var(--border-line);
            padding-bottom: 2rem;
        }

        .single-post h1 {
            font-family: var(--font-headline);
            font-size: 3rem;
            line-height: 1.1;
            margin-bottom: 1rem;
        }

        .single-post .post-meta {
            font-size: 1rem;
            color: var(--text-muted);
            font-style: italic;
        }

        /* Featured Image (Article Page) */
        .featured-image {
            max-width: 740px;
            margin: 0 auto 2rem auto;
            border-radius: 12px;
            overflow: hidden;
        }

        .featured-image img {
            width: 100%;
            height: auto;
            display: block;
        }

        /* Post Card Thumbnail (Homepage) */
        .post-card-image {
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 0.75rem;
        }

        .post-card-image img {
            width: 100%;
            height: 180px;
            object-fit: cover;
            display: block;
            transition: transform 0.3s ease;
        }

        .post-card:hover .post-card-image img {
            transform: scale(1.05);
        }

        .post-content {
            max-width: 740px;
            /* Standard reading width */
            margin: 0 auto;
            font-size: 1.2rem;
            border: none;
            padding: 0;
            box-shadow: none;
            background: transparent;
        }

        /* Drop Cap for first paragraph */
        .post-content>p:first-of-type::first-letter {
            float: left;
            font-family: var(--font-headline);
            font-size: 4.5rem;
            line-height: 0.8;
            padding-right: 12px;
            padding-top: 4px;
            color: var(--accent);
        }

        .post-content h2,
        .post-content h3 {
            font-family: var(--font-headline);
            color: var(--accent);
            margin-top: 2.5rem;
            margin-bottom: 1rem;
        }

        .post-content p {
            margin-bottom: 1.5rem;
            color: var(--text-ink);
        }

        /* Code Blocks (Light Mode) */
        .post-content pre {
            background: #f4f4f4;
            border-left: 4px solid var(--accent);
            padding: 1.5rem;
            overflow-x: auto;
            margin: 2rem 0;
            font-size: 0.95rem;
        }

        .post-content code {
            font-family: 'Courier New', monospace;
            color: #d63384;
            /* Pink/Red for inline code */
            background: rgba(0, 0, 0, 0.05);
            padding: 2px 4px;
            border-radius: 4px;
        }

        .post-content pre code {
            background: transparent;
            color: #333;
            padding: 0;
        }

        /* Footer Meta */
        .article-footer-meta {
            max-width: 740px;
            margin: 4rem auto 0;
            border-top: 4px solid var(--accent);
            /* Thick end line */
            padding-top: 2rem;
        }

        .article-footer-meta strong {
            color: var(--accent);
        }

        .tag {
            background: #f0f0f0;
            color: #333;
            border: 1px solid #ddd;
        }

        .tag:hover {
            background: #000;
            color: #fff;
        }

        /* Site Footer */
        .site-footer {
            margin-top: 5rem;
            border-top: 1px solid var(--accent);
            padding: 3rem 0;
            background: var(--bg-footer);
            text-align: center;
            font-family: var(--font-ui);
            font-size: 0.9rem;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .site-header .logo {
                font-size: 2.5rem;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .single-post h1 {
                font-size: 2.25rem;
            }

            /* Mobile Nav Fix */
            .main-nav {
                display: flex;
                justify-content: center;
                /* Center links only */
                align-items: center;
                padding: 0.5rem 1rem;
                position: static;
                /* Let absolute children be relative to .site-header */
            }

            .main-nav ul {
                flex: 1;
                justify-content: center;
                gap: 1rem;
                padding: 0;
                margin: 0;
            }

            .theme-toggle {
                position: absolute;
                /* Relative to .site-header */
                top: 1rem;
                right: 1rem;
                transform: none;
                margin-left: 0;
            }

            .theme-toggle:hover {
                transform: rotate(15deg);
            }
        }
    </style>
    <!-- Optimized Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preload" as="style"
        href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Libre+Franklin:wght@300;500;700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=UnifrakturMaguntia&display=swap">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Libre+Franklin:wght@300;500;700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=UnifrakturMaguntia&display=swap"
        media="print" onload="this.media='all'">
    <noscript>
        <link rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Libre+Franklin:wght@300;500;700&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=UnifrakturMaguntia&display=swap">
    </noscript>
</head>

<body>
    <header class="site-header">
        <a href="https://analyticsdrive.tech/" class="logo">Analytics Drive<span class="dot">.</span></a>
        <nav class="main-nav">
            <ul>
                <li><a href="https://analyticsdrive.tech/">Home</a></li>
                <li><a href="https://analyticsdrive.tech/archives.html">Archives</a></li>
                <li><a href="https://analyticsdrive.tech/categories.html">Categories</a></li>
                <li><a href="https://analyticsdrive.tech/about/">About</a></li>
            </ul>
            <button id="theme-toggle" class="theme-toggle" aria-label="Toggle Dark Mode">
                <span id="theme-icon">üåô</span>
            </button>
        </nav>
        </div>
    </header>


    <main class="container content-wrapper">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://analyticsdrive.tech/leetcode-1251-average-selling-price-sql-solution/"
  },
  "headline": "Cracking LeetCode 1251: Average Selling Price SQL",
  "description": "Master LeetCode 1251: Average Selling Price. Learn to calculate average product prices using SQL JOINS, GROUP BY, and handling date-based conditions for...",
  "image": [
    "https://analyticsdrive.tech/images/leetcode-1251-average-selling-price-sql-solution.webp"
  ],
  "datePublished": "2026-02-18T10:50:00+00:00",
  "dateModified": "2026-02-18T10:50:00+00:00",
  "author": {
    "@type": "Person",
    "name": "Admin",
    "url": "https://analyticsdrive.tech/author/admin.html"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Analytics Drive",
    "logo": {
      "@type": "ImageObject",
      "url": "https://analyticsdrive.tech/favicon.ico"
    }
  }
}
</script>


<article class="single-post">
  <header class="post-header">
    <div class="post-meta">
      <time datetime="2026-02-18T10:50:00+00:00">Wed 18 February 2026</time>
    </div>
    <h1>Cracking LeetCode 1251: Average Selling Price SQL</h1>
  </header>

  <div class="featured-image">
    <img src="https://analyticsdrive.tech/images/leetcode-1251-average-selling-price-sql-solution.webp" alt="Cracking LeetCode 1251: Average Selling Price SQL" loading="lazy" />
  </div>

  <div class="post-content">
    <h2>Unlocking Database Puzzles: LeetCode 1251 Explained</h2>
<p>Welcome to another deep dive into the world of SQL challenges! LeetCode problems aren't just for coding interviews; they're fantastic for honing your database skills. Today, we're tackling LeetCode problem 1251: "Average Selling Price."</p>
<p>This problem is a quintessential example of how real-world business logic translates into SQL queries, requiring a solid understanding of <code>JOIN</code> operations, date range comparisons, and aggregate functions. Let's break it down!</p>
<h3>The Challenge: Average Selling Price</h3>
<p>The goal of this problem is to calculate the average selling price for each product. Sounds simple, right? The twist lies in how product prices can change over time. Each unit of a product might be sold at a different price depending on the date of purchase.</p>
<p>You are provided with two tables:</p>
<ol>
<li>
<p><strong><code>Prices</code></strong>:</p>
<ul>
<li><code>product_id</code> (INT)</li>
<li><code>start_date</code> (DATE)</li>
<li><code>end_date</code> (DATE)</li>
<li><code>price</code> (INT)</li>
</ul>
<p>This table specifies the price of a product during a particular period. Each <code>product_id</code> can have multiple overlapping or non-overlapping price ranges.</p>
</li>
<li>
<p><strong><code>UnitsSold</code></strong>:</p>
<ul>
<li><code>product_id</code> (INT)</li>
<li><code>purchase_date</code> (DATE)</li>
<li><code>units</code> (INT)</li>
</ul>
<p>This table records sales transactions, indicating how many <code>units</code> of a <code>product_id</code> were sold on a specific <code>purchase_date</code>.</p>
</li>
</ol>
<p>Your task is to return a table with <code>product_id</code> and <code>average_price</code> for each product. The <code>average_price</code> should be rounded to two decimal places.</p>
<h3>Decoding the Logic: Strategy Breakdown</h3>
<p>To solve this, we need to correctly link each sale (from <code>UnitsSold</code>) to its corresponding price (from <code>Prices</code>) based on the sale date. Then, we can calculate the total revenue and total units sold for each product to find the average.</p>
<p>Here's the step-by-step strategy:</p>
<h4>1. Joining Tables: The Crucial Link</h4>
<p>The first step is to combine information from <code>UnitsSold</code> and <code>Prices</code>. We need to join them based on <code>product_id</code>. However, a simple <code>JOIN</code> on <code>product_id</code> isn't enough. We also need to ensure that the <code>purchase_date</code> from <code>UnitsSold</code> falls within the <code>start_date</code> and <code>end_date</code> range defined in the <code>Prices</code> table for that specific product.</p>
<p>We'll use an <code>INNER JOIN</code> because we only care about sales for which a valid price exists within the given date ranges.</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span>
<span class="w">    </span><span class="n">us</span><span class="p">.</span><span class="n">product_id</span><span class="p">,</span>
<span class="w">    </span><span class="n">us</span><span class="p">.</span><span class="n">units</span><span class="p">,</span>
<span class="w">    </span><span class="n">p</span><span class="p">.</span><span class="n">price</span><span class="p">,</span>
<span class="w">    </span><span class="n">us</span><span class="p">.</span><span class="n">purchase_date</span><span class="p">,</span>
<span class="w">    </span><span class="n">p</span><span class="p">.</span><span class="n">start_date</span><span class="p">,</span>
<span class="w">    </span><span class="n">p</span><span class="p">.</span><span class="n">end_date</span>
<span class="k">FROM</span>
<span class="w">    </span><span class="n">UnitsSold</span><span class="w"> </span><span class="n">us</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span>
<span class="w">    </span><span class="n">Prices</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">us</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span>
<span class="w">             </span><span class="k">AND</span><span class="w"> </span><span class="n">us</span><span class="p">.</span><span class="n">purchase_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">start_date</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">end_date</span><span class="p">;</span>
</code></pre></div>

<p>This query will give us a combined view, showing each sale transaction with its matching price at the time of purchase.</p>
<h4>2. Calculating Total Revenue and Units</h4>
<p>Once we have the price for each individual sale, we can calculate the revenue generated by that sale (<code>price * units</code>). To find the average selling price for a product, we need:</p>
<ul>
<li><strong>Total Revenue for a Product</strong>: <code>SUM(price * units)</code> for all its sales.</li>
<li><strong>Total Units Sold for a Product</strong>: <code>SUM(units)</code> for all its sales.</li>
</ul>
<p>The average selling price is then <code>(Total Revenue) / (Total Units Sold)</code>.</p>
<h4>3. Grouping by Product</h4>
<p>Since we need the average selling price <em>for each product</em>, we'll use the <code>GROUP BY product_id</code> clause. This aggregates all sales data for a particular product, allowing us to apply our <code>SUM</code> calculations correctly.</p>
<h3>The Complete SQL Solution</h3>
<p>Combining these steps, here's the final SQL query:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span>
<span class="w">    </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="p">,</span>
<span class="w">    </span><span class="c1">-- Calculate total revenue (price * units) and total units sold.</span>
<span class="w">    </span><span class="c1">-- Ensure floating-point division by multiplying by 1.0.</span>
<span class="w">    </span><span class="c1">-- Round the final average price to two decimal places.</span>
<span class="w">    </span><span class="n">ROUND</span><span class="p">(</span><span class="k">SUM</span><span class="p">(</span><span class="n">p</span><span class="p">.</span><span class="n">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">us</span><span class="p">.</span><span class="n">units</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">SUM</span><span class="p">(</span><span class="n">us</span><span class="p">.</span><span class="n">units</span><span class="p">),</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">average_price</span>
<span class="k">FROM</span>
<span class="w">    </span><span class="n">Prices</span><span class="w"> </span><span class="n">p</span>
<span class="k">INNER</span><span class="w"> </span><span class="k">JOIN</span>
<span class="w">    </span><span class="n">UnitsSold</span><span class="w"> </span><span class="n">us</span><span class="w"> </span><span class="k">ON</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">us</span><span class="p">.</span><span class="n">product_id</span>
<span class="w">                </span><span class="k">AND</span><span class="w"> </span><span class="n">us</span><span class="p">.</span><span class="n">purchase_date</span><span class="w"> </span><span class="k">BETWEEN</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">start_date</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">p</span><span class="p">.</span><span class="n">end_date</span>
<span class="k">GROUP</span><span class="w"> </span><span class="k">BY</span>
<span class="w">    </span><span class="n">p</span><span class="p">.</span><span class="n">product_id</span><span class="p">;</span>
</code></pre></div>

<h4>Code Explanation:</h4>
<ul>
<li><strong><code>FROM Prices p INNER JOIN UnitsSold us</code></strong>: We start by joining <code>Prices</code> and <code>UnitsSold</code> tables. We use aliases <code>p</code> and <code>us</code> for brevity.</li>
<li><strong><code>ON p.product_id = us.product_id AND us.purchase_date BETWEEN p.start_date AND p.end_date</code></strong>: This is the core of our join condition. It matches products by their <code>product_id</code> AND ensures that the <code>purchase_date</code> of a unit sold falls within the valid <code>start_date</code> and <code>end_date</code> for that specific product's price.</li>
<li><strong><code>GROUP BY p.product_id</code></strong>: This clause aggregates all rows that have the same <code>product_id</code> into a single group, so our <code>SUM</code> functions work per product.</li>
<li><strong><code>SUM(p.price * us.units)</code></strong>: This calculates the total revenue for all units sold within the valid price ranges for each product.</li>
<li><strong><code>SUM(us.units)</code></strong>: This calculates the total number of units sold within the valid price ranges for each product.</li>
<li><strong><code>* 1.0</code></strong>: This is a common trick in many SQL dialects to ensure that the division performs floating-point arithmetic rather than integer division, preventing truncation of decimal values.</li>
<li><strong><code>ROUND(..., 2) AS average_price</code></strong>: Finally, we divide the total revenue by the total units to get the average price and <code>ROUND</code> it to two decimal places as required by the problem, aliasing the result as <code>average_price</code>.</li>
</ul>
<h3>Why This Matters: Real-World Applications</h3>
<p>Solving problems like LeetCode 1251 isn't just an academic exercise. This exact logic is used in various real-world scenarios:</p>
<ul>
<li><strong>Inventory Valuation</strong>: Calculating the average cost or selling price of inventory over time.</li>
<li><strong>Sales Performance Analysis</strong>: Understanding product profitability when pricing is dynamic.</li>
<li><strong>Financial Reporting</strong>: Aggregating sales data for revenue recognition.</li>
<li><strong>Dynamic Pricing Models</strong>: Feeding historical average prices into algorithms that predict future pricing strategies.</li>
</ul>
<h3>Conclusion: Master Your SQL Joins!</h3>
<p>LeetCode 1251 is a fantastic problem for reinforcing your understanding of <code>INNER JOIN</code> with multiple conditions, date range comparisons, and aggregate functions. The ability to accurately combine and summarize data from different tables based on specific criteria is a fundamental skill for any data professional.</p>
<p>Keep practicing these types of problems, and you'll build a strong foundation for tackling complex database challenges in any environment! Happy coding!</p>
<h2>Further Reading &amp; Resources</h2>
<ul>
<li><strong>LeetCode Problem 1251: Average Selling Price</strong>: <a href="https://leetcode.com/problems/average-selling-price/">https://leetcode.com/problems/average-selling-price/</a></li>
<li><strong>SQL <code>INNER JOIN</code> Clause</strong>: <a href="https://www.w3schools.com/sql/sql_join_inner.asp">https://www.w3schools.com/sql/sql_join_inner.asp</a></li>
<li><strong>SQL <code>GROUP BY</code> Clause</strong>: <a href="https://www.w3schools.com/sql/sql_groupby.asp">https://www.w3schools.com/sql/sql_groupby.asp</a></li>
<li><strong>SQL <code>BETWEEN</code> Operator</strong>: <a href="https://www.w3schools.com/sql/sql_between.asp">https://www.w3schools.com/sql/sql_between.asp</a></li>
<li><strong>SQL <code>ROUND()</code> Function</strong>: <a href="https://www.w3schools.com/sql/func_sqlserver_round.asp">https://www.w3schools.com/sql/func_sqlserver_round.asp</a></li>
</ul>
  </div>

  <div class="article-footer-meta">
    <p><strong>Category:</strong> <a href="https://analyticsdrive.tech/category/sql.html">SQL</a></p>
    <div class="tags-list">
      <strong>Tags:</strong>
      <span class="tag">#LeetCode</span>
      <span class="tag">#SQL</span>
      <span class="tag">#Database</span>
      <span class="tag">#Problem Solving</span>
      <span class="tag">#JOIN</span>
      <span class="tag">#GROUP BY</span>
      <span class="tag">#Data Analysis</span>
    </div>
  </div>

  <div class="related-posts">
    <h3>Related Articles</h3>
    <ul>
      <li><a href="https://analyticsdrive.tech/leetcode-weekly-contest-489-recap-analysis/">LeetCode Weekly Contest 489: Unpacking the Algorithmic Gauntlet</a></li>
      <li><a href="https://analyticsdrive.tech/leetcode-417-pacific-atlantic-water-flow-dfs-solution/">Conquering LeetCode 417: A Deep Dive into Pacific Atlantic Water Flow with DFS</a></li>
    </ul>
  </div>

  <div class="post-footer">
    <a href="https://analyticsdrive.tech/" class="back-link">&larr; Back to Home</a>
  </div>
</article>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; 2026 Analytics Drive.
            </p>
            <div class="social-links">
                <a href="https://twitter.com/analyticsdrive" target="_blank" aria-label="Twitter">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path
                            d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
                    </svg>
                </a>
                <a href="https://www.facebook.com/profile.php?id=61588072082428" target="_blank" aria-label="Facebook">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path
                            d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.791-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
                    </svg>
                </a>
                <a href="https://www.instagram.com/analyticsdrive" target="_blank" aria-label="Instagram">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path
                            d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z" />
                    </svg>
                </a>
                <a href="https://www.reddit.com/r/Analyticsdrive/" target="_blank" aria-label="Reddit">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path
                            d="M12 0A12 12 0 0 0 0 12a12 12 0 0 0 12 12 12 12 0 0 0 12-12A12 12 0 0 0 12 0zm5.01 4.744c.688 0 1.25.561 1.25 1.249a1.25 1.25 0 0 1-2.498.056l-2.597-.547-.8 3.747c1.824.07 3.48.632 4.674 1.488.308-.309.73-.491 1.207-.491.968 0 1.754.786 1.754 1.754 0 .716-.435 1.333-1.01 1.614a3.111 3.111 0 0 1 .042.52c0 2.694-3.13 4.87-7.004 4.87-3.874 0-7.004-2.176-7.004-4.87 0-.183.015-.366.043-.534A1.748 1.748 0 0 1 4.028 12c0-.968.786-1.754 1.754-1.754.463 0 .898.196 1.207.49 1.207-.883 2.878-1.43 4.744-1.487l.885-4.182a.342.342 0 0 1 .14-.197.35.35 0 0 1 .238-.042l2.906.617a1.214 1.214 0 0 1 1.108-.701zM9.25 12C8.561 12 8 12.562 8 13.25c0 .687.561 1.248 1.25 1.248.687 0 1.248-.561 1.248-1.249 0-.688-.561-1.249-1.249-1.249zm5.5 0c-.687 0-1.248.561-1.248 1.25 0 .687.561 1.248 1.249 1.248.688 0 1.249-.561 1.249-1.249 0-.687-.562-1.249-1.25-1.249zm-5.466 3.99a.327.327 0 0 0-.231.094.33.33 0 0 0 0 .463c.842.842 2.484.913 2.961.913.477 0 2.105-.056 2.961-.913a.361.361 0 0 0 .029-.463.33.33 0 0 0-.464 0c-.547.533-1.684.73-2.512.73-.828 0-1.979-.196-2.512-.73a.326.326 0 0 0-.232-.095z" />
                    </svg>
                </a>
            </div>
        </div>
    </footer>

    <script>
        const toggleButton = document.getElementById('theme-toggle');
        const themeIcon = document.getElementById('theme-icon');
        const html = document.documentElement;

        // Check local storage or system preference
        const savedTheme = localStorage.getItem('theme');
        const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (savedTheme === 'dark' || (!savedTheme && systemDark)) {
            html.setAttribute('data-theme', 'dark');
            themeIcon.textContent = '‚òÄÔ∏è';
        }

        toggleButton.addEventListener('click', () => {
            const currentTheme = html.getAttribute('data-theme');
            if (currentTheme === 'dark') {
                html.removeAttribute('data-theme');
                localStorage.setItem('theme', 'light');
                themeIcon.textContent = 'üåô';
            } else {
                html.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
                themeIcon.textContent = '‚òÄÔ∏è';
            }
        });

        // --- External Link Hygiene ---
        // Adds rel="noopener noreferrer" + target="_blank" to all external links
        (function () {
            const siteHost = window.location.hostname;
            document.querySelectorAll('a[href^="http"]').forEach(function (link) {
                try {
                    const linkHost = new URL(link.href).hostname;
                    if (linkHost !== siteHost) {
                        link.setAttribute('rel', 'noopener noreferrer');
                        link.setAttribute('target', '_blank');
                    }
                } catch (e) { }
            });
        })();
    </script>

</body>

</html>